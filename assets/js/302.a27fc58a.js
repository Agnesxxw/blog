(window.webpackJsonp=window.webpackJsonp||[]).push([[302],{586:function(t,s,a){"use strict";a.r(s);var n=a(12),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("随着项目体积的增加，参与到项目中的同学越来越多，每个人都有自己的打 git log 的习惯：")]),t._v(" "),a("ul",[a("li",[t._v("格式 1: "),a("code",[t._v("add: 添加...")])]),t._v(" "),a("li",[t._v("格式 2: "),a("code",[t._v("[add]: 添加...")])]),t._v(" "),a("li",[t._v("格式 3: "),a("code",[t._v("Add 添加...")])])]),t._v(" "),a("p",[t._v("为了形成统一的规范，达成共识，从而降低协作开发成本，需要对 git commit 记录进行规范。")]),t._v(" "),a("h2",{attrs:{id:"规范-git-commit-记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#规范-git-commit-记录"}},[t._v("#")]),t._v(" 规范 git commit 记录")]),t._v(" "),a("p",[t._v("规范 git commit 记录，需要做两件事情：")]),t._v(" "),a("ul",[a("li",[t._v("通过交互式命令行，自动生成符合指定规范的 commit 记录")]),t._v(" "),a("li",[t._v("提交记录后，在 git hooks 中进行 commit 记录格式检查")])]),t._v(" "),a("p",[t._v("问：既然已经交互式生成了规范记录，为什么需要在 hooks 进行检查？")]),t._v(" "),a("p",[t._v("交互式生成 commit 记录，需要用户调用自定义的 npm scripts，例如"),a("code",[t._v("npm run commit")]),t._v("。但还是可以直接调用原生 git 命令 "),a("code",[t._v("git commit")]),t._v(" 来提交记录。而检查是在正式提交前进行的，因此不符合要求的记录不会生效，需要重新 commit。")]),t._v(" "),a("h2",{attrs:{id:"调研：交互式-commit-log-规范方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调研：交互式-commit-log-规范方案"}},[t._v("#")]),t._v(" 调研：交互式 commit log 规范方案")]),t._v(" "),a("p",[t._v("前期调研结果，关于 commit 提示有两种做法：")]),t._v(" "),a("ol",[a("li",[t._v("直接使用 commitizen 中常用的 adapter")]),t._v(" "),a("li",[t._v("根据团队的需要，自定义 adapter")])]),t._v(" "),a("p",[a("strong",[t._v("方法 1 的优缺点：")])]),t._v(" "),a("p",[t._v("优点 1: 直接安装对应的 adapter 即可")]),t._v(" "),a("p",[t._v("优点 2: 无开发成本")]),t._v(" "),a("p",[t._v("缺点 1: 无法定制，不一定满足团队需要")]),t._v(" "),a("p",[a("strong",[t._v("方法 2 的优缺点：")])]),t._v(" "),a("p",[t._v("优点 1: 可定制，满足开发需求")]),t._v(" "),a("p",[t._v("优点 2: 单独成库，发布 tnpm，作为技术建设")]),t._v(" "),a("p",[t._v("缺点 1: 需要单独一个仓库（但开发成本不高）")]),t._v(" "),a("h2",{attrs:{id:"代码实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码实现"}},[t._v("#")]),t._v(" 代码实现")]),t._v(" "),a("p",[t._v("在实际工作中，发现方法 1 中的常用规范，足够覆盖团队日常开发场景。所以，选择了方法 1.")]),t._v(" "),a("p",[t._v("step1: 安装 npm 包")]),t._v(" "),a("div",{staticClass:"language-PowerShell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[t._v("npm i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("save-dev")]),t._v(" commitizen cz"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("conventional"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("changelog @commitlint"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cli")]),t._v(" @commitlint"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("conventional husky\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("添加 package.json 的配置：")]),t._v(" "),a("div",{staticClass:"language-JSON line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commit"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"git-cz"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"husky"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hooks"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commit-msg"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"commitlint -E HUSKY_GIT_PARAMS"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"config"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commitizen"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"path"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./node_modules/cz-conventional-changelog"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br")])]),a("p",[t._v("在项目根目录下创建"),a("code",[t._v("commitlint.config.js")]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-JavaScript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@commitlint/config-conventional"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("使用方法：不再使用"),a("code",[t._v("git commit -m ...")]),t._v("，而是调用"),a("code",[t._v("npm run commit")]),t._v("。")])])}),[],!1,null,null,null);s.default=e.exports}}]);